<Mods LoadCommand = "%xero(function(self)
	self:SetVanishPoint(scx, scy)
	self:fov(45)
	P1:hidden(1)
	P2:hidden(1)
	
	local function setupProxy(proxy, target, pn)
		proxy:SetTarget(target)
		proxy:xy(scx * (((pn-1)%2)+0.5), scy)
		target:hidden(1)
		target:sleep(9e9)
	end
	
	-- notefield proxies
	for pn = 1, #PP do
		setupProxy(PP[pn], P[(pn-1)%2+1]:GetChild('NoteField'), pn)
	end
	
	-- judgment / combo proxies
	for pn = 1, 2 do
		setupProxy(PC[pn], P[pn]:GetChild('Combo'), pn)
		setupProxy(PJ[pn], P[pn]:GetChild('Judgment'), pn)
	end
	-- your code goes here here:
	--im putting all initial bg stuff here :]

vignette[1]:hidden(1)
vignette[1]:blend('modulate')
vignette[1]:xy(scx,scy)
vignette[1]:zoomto(sw*2,sw*2)
vignette[1]:diffusealpha(0.001)

vignette[2]:hidden(0)
vignette[2]:blend('subtract')
vignette[2]:xy(scx,scy)
vignette[2]:zoomto(sw,sw)

gradient_full:hidden(0)
gradient_full:diffuse(1,0.8,0.9,1)
gradient_full:xy(scx,scy)
gradient_full:zoomto(sw,sh)

gradient:hidden(0)
gradient:diffuse(1,0.8,0.9,1)
gradient:xy(scx,scy)
gradient:zoomto(sw,sh)

star[1]:hidden(0)
star[1]:xy((math.random()*100)*scx*0.02,scy*3)
star[1]:diffusealpha(0.2)
star[1]:blend('add')
star[1]:zoomto(sw*0.25,sw*0.25)

star[2]:hidden(1)
star[2]:xy(scx,scy)
star[2]:zoomto(sw*0.05,sw*0.05)

mang_initial[1]:xy(scx,scy)
mang_initial[1]:diffuse(0,0,0,1)
mang_initial[1]:zoomto(sw,sh)
mang_initial[1]:hidden(0)

mang_initial[2]:xy(scx,scy)
mang_initial[2]:diffuse(0.5*0.3,0.1*0.3,0.1*0.3,1)
mang_initial[2]:zoomto(sw,sh)
mang_initial[2]:hidden(0)

mang_aftsprite1:xy(scx,scy)
mang_aftsprite1:hidden(0)
mang_aftsprite1:SetTextureFiltering(false)
mang_aftsprite1:SetTexture(mang_aft1:GetTexture())

mang_aft1:xy(scx,scy)
mang_aft1:hidden(0)

solarize[1]:hidden(0)
solarize[1]:diffuse(1,1,1,0)
solarize[1]:blend('invertdest')
solarize[1]:xy(scx,scy)
solarize[1]:zoomto(sw,sh)

solarize[2]:hidden(0)
solarize[2]:diffuse(1,1,1,0)
solarize[2]:blend('invertdest')
solarize[2]:xy(scx,scy)
solarize[2]:zoomto(sw,sh)

mang_BA[1]:hidden(1)
mang_BA[1]:xy(scx-(scx*0.02),(scy*2-(scy*-0.08))*0.3)
mang_BA[1]:zoomto(sw*0.95,sw*0.35)
mang_BA[1]:SetTextureFiltering(false)

mang_BA[2]:hidden(1)
mang_BA[2]:xy(scx-(scx*-0.02),(scy*2-(scy*0.08))*0.75)
mang_BA[2]:zoomto(sw*0.95,sw*0.35)
mang_BA[2]:SetTextureFiltering(false)

mang_BA[3]:hidden(1)
mang_BA[3]:xy(scx,scy)
mang_BA[3]:zoomto(sw*1,sh*0.6)
mang_BA[3]:SetTextureFiltering(false)

for i=1,4 do
	mang_BA2[i]:hidden(0)
	mang_BA2[i]:xy(scx,scy)
	mang_BA2[i]:zoom(2)
	mang_BA2[i]:diffusealpha(0.25)
	mang_BA2[i]:blend('modulate')
	mang_BA2[i]:SetTextureFiltering(false)
	mang_BA2[i]:vibrate(1)
	mang_BA2[i]:effectmagnitude(sw/4,sh/4,0)
end

FishSprite:SetTexture(FishAft:GetTexture())
FishSprite:hidden(1)
FishSprite:SetTextureFiltering(false)
FishSprite:GetShader():uniform1f('amount',0)

	--im putting all initial mods stuff here :]
func{0,function(beat)
	for i=1,2 do	
		PP[i]:x(scx)
	end
end}
set{0,2,'xmod',
	200,'zoomz',
	100,'stealthpastreceptors',
	1,'alphastealth0',
	1,'alphastealth1',
	1,'alphastealth2',
	1,'alphastealth3',
	1,'recursezoom',
	1,'judgezoom',
	3*scy,'grad1posy',
	5*scy,'grad2posy',
	scy*3,'stary',
}
--local functions
--col specific alphastealth
aux{'alphastealth0','alphastealth1','alphastealth2','alphastealth3'}
func{0,9e9,function(beat,poptions)
  for pn = 1,2 do
    for col = 0,3 do
      P[pn]:SetNumArrowGradientPoints(col,1)
      P[pn]:SetArrowGradientPoint(0,col,1)
      P[pn]:SetArrowGradientColor(0,col,1,1,1,poptions[pn]['alphastealth'..col])
    end
  end
end}

--[[local function alphastealth(amt)
	for col=0,3 do
		for i=1,2 do
			P[i]:SetNumArrowGradientPoints(col,1)
			P[i]:SetArrowGradientPoint(0,col,1)
			P[i]:SetArrowGradientColor(0,col,1,1,1,amt)
		end
	end
end
aux 'alphastealth'
node{'alphastealth',alphastealth}

local function alphastealth0(amt)
	for i=1,2 do
		P[i]:SetNumArrowGradientPoints(0,1)
		P[i]:SetArrowGradientPoint(0,0,1)
		P[i]:SetArrowGradientColor(0,0,1,1,1,amt)
	end
end
aux 'alphastealth0'
node{'alphastealth0',alphastealth0}
--col 1
local function alphastealth1(amt)
	for i=1,2 do
		P[i]:SetNumArrowGradientPoints(1,1)
		P[i]:SetArrowGradientPoint(0,1,1)
		P[i]:SetArrowGradientColor(0,1,1,1,1,amt)
	end
end
aux 'alphastealth1'
node{'alphastealth1',alphastealth1}
--col 2
local function alphastealth2(amt)
	for i=1,2 do
		P[i]:SetNumArrowGradientPoints(2,1)
		P[i]:SetArrowGradientPoint(0,2,1)
		P[i]:SetArrowGradientColor(0,2,1,1,1,amt)
	end
end
aux 'alphastealth2'
node{'alphastealth2',alphastealth2}
--col 3
local function alphastealth3(amt)
	for i=1,2 do
		P[i]:SetNumArrowGradientPoints(3,1)
		P[i]:SetArrowGradientPoint(0,3,1)
		P[i]:SetArrowGradientColor(0,3,1,1,1,amt)
	end
end
aux 'alphastealth3'
node{'alphastealth3',alphastealth3}]]--

--the rest
local function thecamellia(hits)
	for i=1,4 do
		mang_BA2[i]:effectmagnitude(sw/hits,sh/hits,0)
	end
end
aux 'thecamellia'
node{'thecamellia',thecamellia}

local function thecamellia2(hits)
	for i=1,4 do
		mang_BA2[i]:diffusealpha(hits)
	end
end
aux 'thecamellia2'
node{'thecamellia2',thecamellia2}

local function recursezoom(amt)
	mang_aftsprite1:zoom(amt)
end
aux 'recursezoom'
node{'recursezoom',recursezoom}

local function recurse1(amt)
	mang_aftsprite1:diffusealpha(amt)
end
aux 'recursediff'
node{'recursediff',recurse1}

local function recursevelocityx(amt)
	mang_aftsprite1:x(scx+amt)
end
aux 'recursevx'
node{'recursevx',recursevelocityx}

local function recursevelocityy(amt)
	mang_aftsprite1:y(scy+amt)
end
aux 'recursevy'
node{'recursevy',recursevelocityy}

local function noteinvertdest(amt)
	solarize[1]:diffusealpha(amt)
	solarize[2]:diffusealpha(amt)
end
aux 'noteinv'
node{'noteinv',noteinvertdest}

local function baa1(amt)
	mang_BA[1]:zoom(amt)
end
aux 'baa1zoom'
node{'baa1zoom',baa1}

local function baa2(amt)
	mang_BA[2]:zoom(amt)
end
aux 'baa2zoom'
node{'baa2zoom',baa2}

local function baa3(amt)
	mang_BA[3]:zoom(amt)
end
aux 'baa3zoom'
node{'baa3zoom',baa3}

local function baa3S(amt)
	mang_BA[3]:skewx(amt)
	for i=1,4 do
		mang_BA2[i]:skewx(amt)
	end
end
aux 'baa3skew'
node{'baa3skew',baa3S}

local function baa3y(amt)
	mang_BA[3]:zoomy(amt)
	for i=1,4 do
		mang_BA2[i]:zoomy(amt)
	end
end
aux 'baa3y'
node{'baa3y',baa3y}

local function vigamt(amt)
	vignette[2]:diffuse(1,1,1,amt)
end
aux 'vigdiff'
node{'vigdiff',vigamt}

local function judgezoom(amt)
	for i=1,2 do
		PJ[i]:zoom(amt)
	end
end
aux 'judgezoom'
node{'judgezoom',judgezoom}

local function vibratep(amt)
	for i=1,2 do
		PP[i]:vibrate(1)
		PP[i]:effectmagnitude(amt,amt,0)
	end
end
aux 'playervibrate'
node{'playervibrate',vibratep}

function feesh(feeshamt)
	FishSprite:GetShader():uniform1f('amount',feeshamt)
end
aux 'fisheye'
node{'fisheye',feesh}

function gradpos1(amt)
	gradient:y(amt)
end
aux 'grad1posy'
node{'grad1posy',gradpos1}

function gradpos2(amt)
	gradient_full:y(amt)
end
aux 'grad2posy'
node{'grad2posy',gradpos2}

function stary(amt)
	star[1]:y(amt)
end
aux 'stary'
node{'stary',stary}

function starx(amt)
	star[1]:x(amt)
end
aux 'starx'
node{'starx',starx}

--[[local function p2vibrate(amt)
	for i=1,2 do
		PJ[i]:zoom(amt)
	end
end
aux 'judgezoom'
node{'judgezoom',judgezoom}]]--

end)"
Type = "ActorFrame"
><children>
	<Layer Type = "Quad" Name = "mang_initial[1]" />
	<Layer Type = "Quad" Name = "mang_initial[2]" />
	<Layer Type = "Quad" Name = "gradient_full" />
	<Layer File = "mang/elements/gradient.png" Name = "gradient" />
	
	<Layer Type = "Sprite" InitCommand = "%xero.sprite" Name = "mang_aftsprite1" />
	
	<Layer File = "spellcards.xml" />

	<Layer File = "mang/default.xml" />
	<Layer File = "yasmyn64/default.xml" />

	<Layer File = "notedata/recurse1.xml" />
	<Layer File = "notedata/synth.xml" />

	<Layer Type = "ActorProxy" Name = "PC[1]" />
	<Layer Type = "ActorProxy" Name = "PC[2]" />
	<Layer Type = "ActorProxy" Name = "PJ[1]" />
	<Layer Type = "ActorProxy" Name = "PJ[2]" />

	<Layer Type = "Quad" Name = "solarize[2]" />

	<Layer Type = "ActorProxy" Name = "PP[1]" />
	<Layer Type = "ActorProxy" Name = "PP[2]" />

	<Layer Type = "Quad" Name = "solarize[1]" />

	
	<Layer File = "mang/elements/BA1.png" Name = "mang_BA[1]" />
	<Layer File = "mang/elements/BA2.png" Name = "mang_BA[2]" />
	<Layer File = "mang/elements/BA3.png" Name = "mang_BA[3]" />

	<Layer File = "mang/elements/BA21.png" Name = "mang_BA2[1]" />
	<Layer File = "mang/elements/BA22.png" Name = "mang_BA2[2]" />
	<Layer File = "mang/elements/BA23.png" Name = "mang_BA2[3]" />
	<Layer File = "mang/elements/BA24.png" Name = "mang_BA2[4]" />

	<Layer Type = "ActorFrameTexture" InitCommand = "%xero.aft" Name = "mang_aft1" />	

	<Layer File = "vignette.png" Name = "vignette[1]" />
	<Layer File = "vignette2.png" Name = "vignette[2]" />

	<Layer File = "mang/elements/sparkles.png" Name = "star[1]" />
	<Layer File = "mang/elements/star.png" Name = "star[2]" />

	<Layer Type="ActorFrameTexture" InitCommand="%xero.aft" Name="FishAft" />
	<Layer Type="Sprite" Frag="shaders/fisheye.frag" InitCommand="%xero.sprite" Name="FishSprite"/>
	
</children></Mods>
